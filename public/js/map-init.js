var geojson,map_p_markers,bounds=new L.LatLngBounds(new L.LatLng(-7.540849,111.167564),new L.LatLng(-8.182266,111.813011)),mapurl1="//server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",mapurl2="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",osm=L.tileLayer(mapurl2,{maxZoom:18,minZoom:10,attribution:'&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),map=new L.Map("mapid",{center:bounds.getCenter(),latlng:["-7.866688","111.466614"],zoom:10,layers:[osm],maxBounds:bounds,maxBoundsViscosity:1}),greenIcon=new L.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),goldIcon=new L.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),zoomto="kec",info=L.control();function highlightFeature(e){var o=e.target;o.setStyle({weight:5,color:"#666",dashArray:"",fillOpacity:.4}),L.Browser.ie||L.Browser.opera||L.Browser.edge||o.bringToFront(),info.update(o.feature.properties)}function resetHighlight(e){geojson.resetStyle(e.target),info.update()}function zoomToFeature(e){"kec"==zoomto?(map.removeLayer(geojson),map.removeLayer(map_p_markers),zoomto="desa",loadMapArea(baseUrl+"/api/map/kec/"+e.target.feature.properties.kec_id,function(){map.fitBounds(geojson.getBounds())})):map.fitBounds(e.target.getBounds())}function onEachFeature(e,o){o.on({mouseover:highlightFeature,mouseout:resetHighlight,click:zoomToFeature})}function awMarker(e,o){return L.divIcon({className:"custom-div-icon",html:`<div style='background-color: ${o} !important;' class='marker-pin'></div><i class='fa fa-${e} awesome text-white'></i>`,iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[-10,-26],shadowAnchor:[10,12]})}info.onAdd=function(e){return this._div=L.DomUtil.create("div","leaflet-side-info"),this.update(),this._div},info.update=function(e){this._div.innerHTML="<h4>Informasi Peta</h4>"+(e?`<b> Wilayah ${e.provinsi} </b><br>\n                Kab. ${e.kabupaten} <br>\n                Kec. ${e.kecamatan} <br>\n                ${e.desa} <br>\n                `:"tunjuk daerah")},info.addTo(map);let markers={};for(const e in available_marker)if(available_marker.hasOwnProperty(e)){const o=available_marker[e];markers[e]=awMarker(o,e)}var kecColors=["#85B569","#23D37C","#73B1F7","#644C9D","#2F066E","#9E77D0","#26F0CD","#973C84","#F09518","#FDB2C2","#40B014","#888C18","#B7B638","#995C9D","#9C4882","#79A8BA","#A16EDC","#2B2588","#BCB9DC","#B2FA9C"];function kecColor(e){return kecColors[e-1]}function getRandomColor(){for(var e="#",o=0;o<6;o++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}function getColor(e){return e>1e3?"#800026":e>500?"#BD0026":e>200?"#E31A1C":e>100?"#FC4E2A":e>50?"#FD8D3C":e>20?"#FEB24C":e>10?"#FED976":"#16990D"}function loadMapArea(e,o,r,t){o=o||function(){},r=(r=r||!1)||!1,axios.get(e).then(function(e){geojson=L.geoJSON(e.data,{style:function(e){let o;return{color:o="kec"==zoomto?kecColor(e.properties.kec_id):getColor(e.properties.penduduk_total),weight:.5,opacity:1}},onEachFeature:r?function(){}:onEachFeature}),t||(geojson=geojson.bindPopup(function(e){return e.feature.properties.map_content},{direction:"right",permanent:!1,sticky:!0,offset:[10,0],opacity:.75,className:"leaflet-c-popup"})),geojson.addTo(map),o()}).catch(function(e){console.log(e)})}function loadMapMarker(e,o,r){o=o||{},r=r||function(){},axios.get(e,{params:o}).then(function(e){map_p_markers=L.geoJSON(e.data,{pointToLayer:function(e,o){return L.marker(o,{icon:markers[e.properties.marker_color]})}}).bindPopup(function(e){return e.feature.properties.map_content},{direction:"right",permanent:!1,sticky:!0,offset:[10,0],opacity:.75,className:"leaflet-c-popup"}).addTo(map),r()}).catch(function(e){console.log(e)})}
