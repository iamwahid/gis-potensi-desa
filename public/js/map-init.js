var geojson,map_p_markers,bounds=new L.LatLngBounds(new L.LatLng(-7.540849,111.167564),new L.LatLng(-8.182266,111.813011)),mapurl1="//server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",mapurl2="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",osm=L.tileLayer(mapurl2,{maxZoom:18,minZoom:10,attribution:'&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),map=new L.Map("mapid",{center:bounds.getCenter(),latlng:["-7.866688","111.466614"],zoom:10,layers:[osm],maxBounds:bounds,maxBoundsViscosity:1}),greenIcon=new L.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),goldIcon=new L.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),zoomto="kec",info=L.control();function highlightFeature(o){var e=o.target;e.setStyle({weight:5,color:"#666",dashArray:"",fillOpacity:.4}),L.Browser.ie||L.Browser.opera||L.Browser.edge||e.bringToFront(),info.update(e.feature.properties)}function resetHighlight(o){geojson.resetStyle(o.target),info.update()}function zoomToFeature(o){"kec"==zoomto?(map.removeLayer(geojson),map.removeLayer(map_p_markers),zoomto="desa",loadMapArea(baseUrl+"/api/map/kec/"+o.target.feature.properties.kec_id,function(){map.fitBounds(geojson.getBounds())},!1,!1)):map.fitBounds(o.target.getBounds())}function onEachFeature(o,e){e.on({mouseover:highlightFeature,mouseout:resetHighlight,click:zoomToFeature,dblclick:function(o){console.log("dbl click")}})}function awMarker(o,e){return L.divIcon({className:"custom-div-icon",html:`<div style='background-color: ${e} !important;' class='marker-pin'></div><i class='fa fa-${o} awesome text-white'></i>`,iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[-10,-26],shadowAnchor:[10,12]})}info.onAdd=function(o){return this._div=L.DomUtil.create("div","leaflet-side-info"),this.update(),this._div},info.update=function(o){this._div.innerHTML="<h4>Informasi Peta</h4>"+(o?`<b> Wilayah ${o.provinsi} </b><br>\n                Kab. ${o.kabupaten} <br>\n                Kec. ${o.kecamatan} <br>\n                ${o.desa} <br>\n                `:"tunjuk daerah")},info.addTo(map);let markers={};for(const o in available_marker)if(available_marker.hasOwnProperty(o)){const e=available_marker[o];markers[o]=awMarker(e,o)}var kecColors=["#85B569","#23D37C","#73B1F7","#644C9D","#2F066E","#9E77D0","#26F0CD","#973C84","#F09518","#FDB2C2","#40B014","#888C18","#B7B638","#995C9D","#9C4882","#79A8BA","#A16EDC","#2B2588","#BCB9DC","#B2FA9C"];function kecColor(o){return kecColors[o-1]}function getRandomColor(){for(var o="#",e=0;e<6;e++)o+="0123456789ABCDEF"[Math.floor(16*Math.random())];return o}function getColor(o){return o>1e3?"#800026":o>500?"#BD0026":o>200?"#E31A1C":o>100?"#FC4E2A":o>50?"#FD8D3C":o>20?"#FEB24C":o>10?"#FED976":"#16990D"}function loadMapArea(o,e,r,t){e=e||function(){},r=(r=r||!1)||!1,axios.get(o).then(function(o){geojson=L.geoJSON(o.data,{style:function(o){let e;return{color:e="kec"==zoomto?kecColor(o.properties.kec_id):getColor(o.properties.penduduk_total),weight:.5,opacity:1}},onEachFeature:r?function(){}:onEachFeature}),t||(geojson=geojson.bindPopup(function(o){return o.feature.properties.map_content},{direction:"right",permanent:!1,sticky:!0,offset:[10,0],opacity:.75,className:"leaflet-c-popup"})),geojson.addTo(map),e()}).catch(function(o){console.log(o)})}function loadMapMarker(o,e,r){e=e||{},r=r||function(){},axios.get(o,{params:e}).then(function(o){map_p_markers=L.geoJSON(o.data,{pointToLayer:function(o,e){return L.marker(e,{icon:markers[o.properties.marker_color]})}}).bindPopup(function(o){return o.feature.properties.map_content},{direction:"right",permanent:!1,sticky:!0,offset:[10,0],opacity:.75,className:"leaflet-c-popup"}).addTo(map),r()}).catch(function(o){console.log(o)})}
